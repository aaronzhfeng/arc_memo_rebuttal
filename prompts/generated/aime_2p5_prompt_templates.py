# Auto-generated by scripts/export_prompt_templates.py
# Do not edit directly.

# Stage 1 – Joint Solve + Thought Process (Gemini 2.5)
JOINT_SYSTEM_PROMPT = """You are solving problems from the American Invitational Mathematics Examination (AIME).

Think carefully, explain your reasoning clearly, and finish with a single line of the form:
Final Answer: XYZ

where XYZ is an integer between 0 and 999. Do not place the answer in LaTeX boxes."""

JOINT_PROMPT_TEMPLATE = """### Problem
{problem_text}

Provide a detailed solution strategy. You may include short code snippets, equations, or checks if helpful.
After you are fully satisfied with the reasoning, end with:
Final Answer: XYZ"""

# Stage 2 – Self-Reflection (Gemini 2.5)
REFLECTION_SYSTEM_PROMPT = """You are reviewing your own solution to an AIME problem.

Your goal is to produce an improved thought process:
- Audit the previous reasoning and check the logic carefully.
- Retain useful strategies, calculations, and insights.
- Identify any dubious steps and correct them or flag the uncertainty.
- You may run mental calculations or short code snippets if helpful.
- Do not assume the final answer is correct just because it was written.
- Do not expect external feedback; rely on internal verification.

Write a clear, step-by-step reasoning narrative that would be useful to revisit later."""

REFLECTION_PROMPT_TEMPLATE = """### Problem
{problem_text}

### Previous Attempt
Reasoning:
{attempt_reasoning}

Final Answer Reported: {attempt_answer}

### Task
Review the attempt, assess the logic, and produce an improved thought process that:
- Keeps correct insights and derivations.
- Repairs or replaces questionable steps.
- Notes any uncertainty that cannot be resolved internally.
- Ends with a concise summary of the proposed solution path (do NOT restate a boxed answer).
"""

# Stage 3 – Lesson Abstraction (Gemini 2.5)
EXTRACT_LESSON_FROM_AIME_FS_TEMPLATE_STRICT_UNCERTAIN = """### Introduction

You are analyzing a self-reflection on an AIME (American Invitational Mathematics Examination) problem to extract reusable mathematical reasoning patterns. The reflection may contain unresolved uncertainties, so treat every step with a critical eye.

Your task is to derive problem-solving "rules" that capture:

- a **situation** (what structural pattern to recognize), and
- a **suggestion** (what concrete technique to try).

### Instructions

We will provide you with the solver's revised reasoning process (the reflection).

Your job is to output ONLY a markdown YAML block containing 2–5 lessons, each of the form:

```yaml
- situation: [mathematical pattern or condition to recognize]
  suggestion: [technique or approach to try]
```

No extra prose, no headings, no explanation outside the YAML list.

Design the lessons with the following constraints:

1. **General but Detectable Situations**
   - Describe structural patterns, not specific numbers.
   - Parameterize values: e.g. say "when two overlapping products share a variable and their constants are coprime" instead of "when abc=70 and cde=71."
   - It is acceptable to mention qualitative properties like "prime," "perfect square," "consecutive integers," "equally spaced points," "similar triangles," etc.

2. **Concrete, Executable Suggestions**
   - Each *suggestion* must describe specific mathematical actions a capable student could carry out: introduce a variable, write a recurrence, apply similarity, set up a system, use the shoelace formula, count lattice points, etc.
   - Avoid vague advice like "analyze carefully," "be systematic," or "consider symmetry" unless you immediately follow it with a concrete procedure.
   - At least **one** lesson must encode the **main key step** from the reflection in an explicit way (for example, "define P(k) as … and write a recurrence P(k) = …", or "view each k-digit block of 9s as 10^k − 1 and sum these as a geometric series").

3. **AIME-Level Methods Only**
   - Use tools appropriate for AIME: algebraic manipulation, inequalities, modular arithmetic, recurrences, casework, combinatorial counting, similarity, Pythagorean triples, coordinate geometry, area/ratio arguments, parity, basic number theory (gcd/lcm, prime factorization, divisor-count formulas), etc.
   - Do NOT invoke heavy or unnecessary methods such as Fourier analysis, character sums, measure theory, advanced group theory, or anything beyond typical high-school olympiad/AIME level.

4. **Avoid Problem-Specific Overfitting**
   - Do not refer to problem labels, specific variable names from the statement, or the problem's numerical constants.
   - Do NOT restate the original problem in disguise.
   - Ask yourself: "Would this lesson still be useful if all the numbers were changed but the structure stayed the same?" If not, generalize it.

5. **No Trivial or Meta Advice**
   - Do not include lessons like "re-read the problem," "check your arithmetic," or "answer the question at the end."
   - Focus only on *mathematical structure* and *methods*.

6. **Faithfulness to the Reflection**
   - Base your lessons on actual reasoning steps visible in the reflection.
   - You may compress, reorganize, or generalize those steps, but do not invent fundamentally different solution methods that are not suggested by the reasoning.
   - If the reflection describes a correction of a previous error, formulate the lesson as the correct strategy (and optionally a brief warning of the pitfall) in general terms.

7. **Safeguards for Uncertain Reasoning**
   - Highlight verification steps or self-checks whenever the reflection signals doubt or unproven assumptions.
   - If a step hinges on an unchecked claim, pair it with a diagnostic action that would confirm or refute the claim.

### Examples
{examples}

### Refined Thought Process
{thought_process}
"""

# Stage 4 – Lesson Retrieval (Gemini 2.5)
AIME_RET_TOPK_CONCEPT_TEMPLATE_2P5 = """### Context
{aime_context}

### Task
You are given an AIME problem and a catalog of lessons. Each lesson has:
- **situation** – when the lesson is applicable
- **suggestion** – the recommended strategy or check

Choose the {top_k} lessons whose situations *truly* match the structure of the
problem and whose suggestions would materially help reach the boxed integer
answer. Favor lessons that align with the problem's mathematical domain and the
specific reasoning steps implied by the statement. Discard lessons that only
vaguely relate. If relevance is uncertain, prefer lessons that offer diagnostic
checks (e.g., parity, modular sanity checks) to catch mistakes.

Return the lesson numbers in a YAML list, ordered by decreasing relevance, like this:
```yaml
- 3
- 12
- 19
- 7
- 25
```

### Lessons
{concept_list}

### AIME Problem
{description}
"""

# Stage 5 – Validation Solve (Gemini 2.5 with lessons)
AIME_SYSTEM_PROMPT_2P5 = """You are solving AIME (American Invitational Mathematics Examination) problems.

You may think step by step internally, but your final answer MUST appear exactly once as \\boxed{XYZ}.

Requirements for the final output:
- Use \\boxed{XYZ} for the answer and nowhere else in the response.
- \\boxed{XYZ} must contain only the integer (0–999) with no spaces, wording, punctuation, or leading zeros (unless the answer is 0).
- Do not print unboxed standalone integers on their own lines; embed intermediate numbers inside sentences or equations.

Example of correct output: \\boxed{237}

Examples of incorrect output: "Final Answer: 237", "237 ", "\\boxed{The answer is 237}", "\\boxed{0237}", or any response with multiple boxed expressions."""

AIME_SOLVE_PROMPT_2P5 = """Solve this AIME problem:

{problem}"""

AIME_OUTPUT_REQUIREMENT_2P5 = """Output only the integer answer, and wrap it exactly once as \\boxed{XYZ}.

Guidelines:
- Mention intermediate numbers only inside sentences/equations so they are not mistaken for answers.
- Do not use \\boxed anywhere else in the response.
- The grader will read the boxed integer wherever it appears."""

# Stage 5 Baseline – Validation Solve (Gemini 2.5 no retrieval)
AIME_SYSTEM_PROMPT_BASELINE_2P5 = """You are solving AIME (American Invitational Mathematics Examination) problems.

You may think step by step internally, but your final answer MUST appear exactly once as \\boxed{XYZ}.

Requirements for the final output:
- Use \\boxed{XYZ} for the answer and nowhere else in the response.
- \\boxed{XYZ} must contain only the integer (0–999) with no spaces, wording, punctuation, or leading zeros (unless the answer is 0).
- Do not print unboxed standalone integers on their own lines; embed intermediate numbers inside sentences or equations.

Example of correct output: \\boxed{237}

Examples of incorrect output: "Final Answer: 237", "237 ", "\\boxed{The answer is 237}", "\\boxed{0237}", or any response with multiple boxed expressions."""

AIME_SOLVE_PROMPT_BASELINE_2P5 = """Solve this AIME problem:

{problem}"""

AIME_OUTPUT_REQUIREMENT_BASELINE_2P5 = """Output only the integer answer, and wrap it exactly once as \\boxed{XYZ}.

Guidelines:
- Mention intermediate numbers only inside sentences/equations so they are not mistaken for answers.
- Do not use \\boxed anywhere else in the response.
- The grader will read the boxed integer wherever it appears."""

